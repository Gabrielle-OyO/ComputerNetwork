#   第四章思考题

#### 4-1：MAC子层概述

 √什么是单播、广播、组播？
单播：单播在发送者和每一接收者之间实现点对点网络连接。 如果一台发送者同时给多个的接收者传输相同 的数据，也必须相应的复制多份的相同数据包。如果有大量主机希望获得数据包的同一份拷贝时， 将 导致发送者负担沉重、延迟长、网络拥塞；为保证一定的服务质量需增加硬件和带宽。
“单播”可以理解为一个人对另外一个人说话，，此时信息的接收和传递只在两个节点之间进行。
![image-20211103191521066](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103191521066.png)
广播：指在IP子网内广播数据包，所有在子网内部的主机都将收到这些数据包。 广播意味着网络向子 网每一个主机都投递一份数据包，不论这些主机是否乐于接收该数据包。所以广播的使用范围非常小， 只在本地子网内有效，通过路由器和交换机网络设备控制广播传输。
“广播”可以理解为一个人通过广播喇叭对在场的全体说话，这样做的好处是通话效率高，信息一下子就可以传递到全体。
![image-20211103191546948](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103191546948.png)
组播：组播在发送者和每一接收者之间实现点对多点网络连接。 如果一台发送者同时给多个的接收者传输 相同的数据，也只需复制一份的相同数据包。它提高了数据传送效率。减少了骨干网络出现拥塞的 可能性。
“多播”可以理解为一个人向多个人（但不是在场的所有人）说话，这样能够提高通话的效率。如果你要通知特定的某些人同一件事情，但是又不想让其他人知道，使用电话一个一个地通知就非常麻烦，而使用日常生活的大喇叭进行广播通知，就达不到只通知个别人的目的了，此时使用“多播”来实现就会非常方便快捷，但是现实生活中多播设备非常少。多播如图3所示。
![image-20211103191610014](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103191610014.png)

 √局域网中主要采用什么数据通信方式？
广播---局域网采用的通信方式，共享传输介质以降低费用。

 √介质访问控制用来做什么？
解决某一时刻由哪个工作站共享信道的问题

 √介质访问控制协议分成哪两类？
静态分配、动态分配

#### 4-2：ALOHA协议

 √纯ALOHA协议的工作原理是什么？
任何一个站都可以在帧生成后立即发送（可能冲突），并通过信号的反馈，检测信道，以确定发送是否成功。
如发送失败，则经随机延时后再发送。
每个站点可在任意时间发送数据（不关心信道是否已被占用）； 两个以上站点都在发送数据时就会发生冲突。

 √纯ALOHA协议的冲突危险期是多少？
2T（过了这个时间就会再发生冲突了）

 √纯ALOHA协议的信道利用率怎样？
纯ALOHA信道的利用率最高为18.4%
![image-20211103192632535](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103192632535.png)
ALOHA吞吐率和G之间的关系
![image-20211103192730783](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103192730783.png)

 √分隙ALOHA协议的工作原理是什么？
分隙ALOHA是把时间分成时隙（时间片）
时隙的长度对应一帧的传输时间。
新帧的产生是随机的，但分隙ALOHA不允许随机发送，凡帧的发送必须在时隙的起点。
冲突只发生在时隙的起点，冲突发生时只浪费一个时隙。一旦某个站占用时隙并发送成功，则在该时隙内不会出现冲突。
![image-20211103192812226](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103192812226.png)

 √分隙ALOHA协议的冲突危险期是多少？
1T

 √分隙ALOHA协议的信道利用率怎样？
分隙ALOHA信道的利用率最高为36.8%
![image-20211103192946130](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103192946130.png)![image-20211103192842482](C:%5CUsers%5C18377%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20211103192842482.png)

#### 4-3：CSMA协议

 √CSMA系列协议的本质是什么？
先听后发：改进ALOHA协议的侦听/发送策略

 √CSMA/CD的基本工作原理是什么？
先听后发，边发边听：半双工以太网中使用

 √什么是冲突危险期？
发生冲突时间的上限，即发送站发出帧后能检测到碰撞的最长时间，数值上等于最远两站传播时间的两倍，即2τ

 √先听后发仍然会发生冲突，原因是什么？
 所有工作站在发送的同时也接收自己的信号，监测发送的情况，一旦收到的信号与发出的不一致，就说明发生了冲突。
 发送站感知冲突后立即停止帧的发送，并且发一个简短的堵塞信号(称强化冲突信号，Jamming signal)，通知网上各站已经发生冲突，本站及网上所有站都等待一段随机分布的时间，然后再按CSMA/CD方式重发该帧。

 √冲突检测的原理是什么？
比较发送信号（A->B）与回复信号（A<-B）的能量或脉冲宽度变化
最大冲突检测时间（冲突窗口）：两个最远距离站点间的传输时间为t，则网络的最大冲突检测时间为2t。

#### 4-4：以太网概述

 √二进制指数回退算法是怎样做的？
 发送方在检测到冲突后，双方（或多方）都将延时一段时间，那么这段时间到底是多长？
 冲突检测到后，时间被分成离散的时隙
 时隙的长度等于信号在介质上来回传输时间（51.2μs ）
 一般地，i 次冲突后，等待的时隙数将从（0~2i-1）×51.2μs中
随机选择。

 √经典以太网的特点是什么？
提高负载的方法
提速到100M
全双工
交换式网络，hub   swicth

 √交换式以太网的特点是什么？
以太网交换机实质就是一个多端口的的网桥，它工作在数据链路层上。每一个端口都直接与一个主机或一个集线器相连，并且是全双工工作。它能同时连通多对端口，使每一对通信能进行无碰撞地传输数据。在通信时是独占而不是和其他网络用户共享传输媒体的带宽。

 √以太网为什么具有强大的生命力？
简单性和灵活性
易于维护
支持TCP/IP，互联容易
善于借鉴：4B/5B，8B/10B......

 √以太网采用的编码方法是什么？
4B/5B Encoding

#### 4-5：以太网的帧

 √以太帧的各字段分别是什么？
前导码、帧起始符；目的地址、源地址；长度字段、数据字段、帧校验字段；

 √如何识别类型/长度字段？
检查这个字段的数值：如果小于等于1536(0x600)，则是长度（802.3）字段，如果大于1536，则表示类型（以太帧）。

 √MAC地址具有那些特征？
MAC地址（物理地址）由48位构成，其中前24位需要向IEEE申请
目的地址 源地址 数据
MAC地址不可更改，全球唯一

 √为什么以太帧最短至少需要64字节？
 CSMA/CD的要求
最短帧的发送时间>=争用时隙t
 以太网（802.3）规定，在10Mbps局域网中
时隙：2t=  51.2 微秒
最短帧长度：10Mbps×2/8 = 64 Byte   或者：（51200/100ns）/8=64Byte

 √请尝试使用报文抓取工具（WireShark）抓取二层帧，请分析抓到的帧的各字段，并判别它属于802.3帧还是DIX以太帧。

#### 4-6：二层交换的基本原理

 √为什么需要二层交换？
 有很多LAN，如何将它们连接起来？
可用网桥（bridges ）将它们连接起来。
 网桥工作在DLL层，通过检查MAC地址做出转发帧的决策
不会检查网络层，所以，IPv4, IPv6, AppleTalk, ATM, IPX, and OSI 分组均可穿越网桥。

 √二层交换的基本原理是什么？
泛洪/扩散
转发
过滤

 √什么是扩散？
OSPF拓扑数据库-就是链路状态数据库。这个数据库由路由器可以接受到的所有LSA组成。在top发生的变化，可以看成LSA的变化。泛洪扩散过程就是将这些变化的货新的LSA发送到整个网络中去，以确保每一个节点的数据库都可以更新，最终保存所有其他节点的数据库的统一性。所谓的泛洪扩散，就是（最新最全）LSA的统一的过程。

 √为什么网桥又叫透明网桥？
透明网桥(transparent bridge)的标准是802.1D。支持这种设计的人首要关心的是完全透明。按照他们的观点，装有多个LAN的单位在买回IEEE标准网桥之后，只需把连接插头插入网桥，就万事大吉。透明网桥是一种即插即用设备，只要把网桥接入局域网，不需要改动硬件和软件，无需设置地址开关，无需装入路由表或参数，网桥就能工作。

 √为什么采用了交换机而不是集线器作为星形拓扑的中心，性能会得到提升？
 网桥/交换机隔离了冲突了

#### 4-7：生成树协议

 √为什么需要冗余拓扑？
为了可靠，采用冗余

 √冗余拓扑会带来什么问题？
冗余造成环路，会产生多帧传送、广播风暴和MAC地址库不稳定等问题

 √怎么解决这些问题？
这些问题的根源就是有环路，STP就是打断环路，维持逻辑上的无环路

 √STP是否消除了冗余拓扑带来的可靠的好处？
SPT可能产生非最优路径（付出的代价），当逻辑STP树上的某点出故障了，非指定端口将会被重新启用。

#### 4-8：虚拟局域网

 √什么是VLAN？
一组逻辑上的用户。

 √VLAN成员可以跨越交换机吗？
可以
 一个VLAN对应一个广播域
 有了VLAN，可使用二层交换机实现广播域的分割
 当一个VLAN跨越几个交换机的时候，使用802.1Q穿越连接交换机的干线当一个VLAN跨越几个交换机的时候，使用802.1Q穿越连接交换机的干线

 √帧标记法有什么用？
帧标记法可以让帧穿过交换机的干线

 √最常用的帧标记法是哪个？
IEEE 802.1Q
 1998年颁布
 一种幁标记方法：VLAN ID
 通过trunk的时候使用

 √采用帧标记法的帧是如何通过干线的？
![image-20211103203028228](04%E7%AC%AC%E5%9B%9B%E7%AB%A0%E6%80%9D%E8%80%83%E9%A2%98.assets/image-20211103203028228.png)

#### 4-9：二层设备

 √网卡的主要功能是什么？
命名、成帧、介质访问控制，再生信号等。

 √交换机的基本工作原理是怎样的？
三选一：泛洪/转发/丢弃
学习

 √交换机内部的MAC地址表是怎么建立和维护的？
 动态更新
直接读取数据包中的源地址信息，存入CAM，如在CAM中
没有找到所需的地址，添加到CAM中
 删除过时的地址记录：时间标记
每增加一条记录，为它打上时间标记
每引用或找到某条记录，为它打上新的时间标记
当某条地址记录超过一定时间没被引用，则删除它

 √交换机能否创建的最小冲突域是多大？
无冲突域
 微分段：LAN被交换机分隔开的网段，在一个大的冲突域中
产生无冲突域。
 虚拟线路：在交换机内部把段连接成一个虚拟网络的电路，
只在需要时才成立

 √三种交换方式的优缺点是什么？
存储转发：指交换机首先在缓冲区中存储整个接收到的封装数据包，然后使用CRC检测法检查数据包是否正确，如果正确，交换机便从地址表中寻找目的端口地址，地址得到后，即建立两个端口的连接并开始传输数据。如果不正确，表明该数据中包含有一个或一个以上的错误，则将予以丢弃。除了检查CRC外，存储转发交换机还将检查整个数据帧，当发现超短帧或超长帧等错误时，也会自动将其过滤掉。
优点是没有残帧或错误帧的转发，减少了潜在的不必要数据转发，提高了网络传输效率。缺点是转发延迟要比直通式长得多。同时，存储转发式交换机通常也需要更大量的内存空间来保存帧。

直通交换：指交换机在接收到帧后，一般只要接收到帧的前6字节(目的MAC地址6字节），就已经知道了目的地了，不进行缓存和奇偶校验，而是直接转发到目的端口。转发反应时间非常短，同时也存在以下3方面的问题：转发残帧、转发错误帧和容易拥塞。

无分片交换：准直通转发模式（Interim cut—trough switch）是对直通转发模式的一种简改进（采用一种特殊的缓存：FIFO），只转发长度至少为64B的帧，从而避免了残帧的转发。